<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>時計の時間あてゲーム</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .clock-face {
            stroke: #333;
            stroke-width: 2;
            fill: white;
        }
        .hour-hand {
            stroke: red;
            stroke-linecap: round;
            stroke-width: 6;
        }
        .minute-hand {
            stroke: blue;
            stroke-linecap: round;
            stroke-width: 4;
        }
        .center-dot {
            fill: #333;
        }
        .hour-marker {
            stroke: #333;
            stroke-width: 2;
        }
        .minute-marker {
            stroke: #666;
            stroke-width: 1;
        }
        .clock-number {
            font-family: sans-serif;
            font-size: 16px;
            text-anchor: middle;
            dominant-baseline: middle;
            fill: #333;
        }
        .minute-number {
            font-family: sans-serif;
            font-size: 8px;
            text-anchor: middle;
            dominant-baseline: middle;
            fill: #555;
            pointer-events: none; /* Make text non-interactive */
        }
        .minute-highlight-circle {
            fill: blue;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="w-full max-w-md mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8 text-center">
        
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">なんじなんぷんかな？</h1>
        
        <!-- 時計のSVGを表示するコンテナ -->
        <div id="clock-container" class="mb-6 flex justify-center">
            <svg id="clock" width="300" height="300" viewBox="0 0 200 200">
                <!-- 時計盤 -->
                <circle class="clock-face" cx="100" cy="100" r="95"/>
                <!-- 目盛り -->
                <g id="markers"></g>
                <!-- 数字 -->
                <g id="numbers"></g>
                <!-- 針 -->
                <line id="hour-hand" class="hour-hand" x1="100" y1="100" x2="100" y2="60"/>
                <line id="minute-hand" class="minute-hand" x1="100" y1="100" x2="100" y2="40"/>
                <!-- 中心の点 -->
                <circle class="center-dot" cx="100" cy="100" r="5"/>
            </svg>
        </div>
        
        <!-- 結果表示エリア -->
        <div id="result-message" class="h-10 text-xl font-semibold text-gray-700 flex items-center justify-center mb-4"></div>
        
        <!-- ボタン -->
        <div class="grid grid-cols-2 gap-4">
            <button id="show-answer-btn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-md transition-colors">
                こたえをみる
            </button>
            <button id="next-question-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-md transition-colors">
                つぎのもんだい
            </button>
        </div>

    </div>

    <script>
        const hourHand = document.getElementById('hour-hand');
        const minuteHand = document.getElementById('minute-hand');
        const markersContainer = document.getElementById('markers');
        const numbersContainer = document.getElementById('numbers');

        const resultMessage = document.getElementById('result-message');
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const showAnswerBtn = document.getElementById('show-answer-btn');
        
        let correctHour;
        let correctMinute;
        let previouslyHighlightedMinuteEl = null;
        let previouslyHighlightedCircleEl = null;

        // 時計の目盛りと数字を生成
        function createMarkers() {
            markersContainer.innerHTML = '';
            numbersContainer.innerHTML = '';

            // 内側の時間 (1-12)
            const hourRadius = 68;
            for (let i = 1; i <= 12; i++) {
                const angle = i * 30;
                const numX = 100 + hourRadius * Math.sin(angle * Math.PI / 180);
                const numY = 100 - hourRadius * Math.cos(angle * Math.PI / 180);
                const number = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                number.setAttribute('x', numX);
                number.setAttribute('y', numY);
                number.setAttribute('class', 'clock-number');
                number.textContent = i;
                numbersContainer.appendChild(number);
            }

            // 外側の分 (00-59)
            const minuteRadius = 86;
             for (let i = 0; i < 60; i++) {
                const angle = i * 6;
                const numX = 100 + minuteRadius * Math.sin(angle * Math.PI / 180);
                const numY = 100 - minuteRadius * Math.cos(angle * Math.PI / 180);
                const number = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                number.setAttribute('x', numX);
                number.setAttribute('y', numY);
                number.setAttribute('class', 'minute-number');
                // 5の倍数の時だけ数字を表示して見やすくする
                if (i % 5 === 0) {
                    number.textContent = i.toString().padStart(2, '0');
                }
                number.setAttribute('id', `minute-text-${i}`);
                numbersContainer.appendChild(number);
            }

            // 目盛り線
            for (let i = 1; i <= 60; i++) {
                const angle = i * 6;
                const isHourMarker = i % 5 === 0;
                const startRadius = isHourMarker ? 90 : 93;
                const endRadius = 95;

                const x1 = 100 + startRadius * Math.sin(angle * Math.PI / 180);
                const y1 = 100 - startRadius * Math.cos(angle * Math.PI / 180);
                const x2 = 100 + endRadius * Math.sin(angle * Math.PI / 180);
                const y2 = 100 - endRadius * Math.cos(angle * Math.PI / 180);

                const marker = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                marker.setAttribute('x1', x1);
                marker.setAttribute('y1', y1);
                marker.setAttribute('x2', x2);
                marker.setAttribute('y2', y2);
                marker.setAttribute('class', isHourMarker ? 'hour-marker' : 'minute-marker');
                markersContainer.appendChild(marker);
            }
        }

        // 時計を指定した時間に設定する関数
        function setClock(hour, minute) {
            const hourAngle = (hour % 12 + minute / 60) * 30;
            const minuteAngle = minute * 6;
            hourHand.setAttribute('transform', `rotate(${hourAngle} 100 100)`);
            minuteHand.setAttribute('transform', `rotate(${minuteAngle} 100 100)`);
        }

        // 新しい問題を生成する関数
        function generateNewProblem() {
            // 前回のハイライトをリセット
            if (previouslyHighlightedCircleEl) {
                previouslyHighlightedCircleEl.remove();
                previouslyHighlightedCircleEl = null;
            }
            if (previouslyHighlightedMinuteEl) {
                previouslyHighlightedMinuteEl.setAttribute('fill', '#555');
                previouslyHighlightedMinuteEl.setAttribute('font-weight', 'normal');
                const prevMinute = parseInt(previouslyHighlightedMinuteEl.id.replace('minute-text-', ''));
                if (prevMinute % 5 !== 0) {
                     previouslyHighlightedMinuteEl.textContent = '';
                }
            }

            correctHour = Math.floor(Math.random() * 12); // 0-11時
            correctMinute = Math.floor(Math.random() * 60); // 0-59分（1分単位）
            
            setClock(correctHour, correctMinute);
            
            // 現在の分の数字をハイライト
            const currentMinuteEl = document.getElementById(`minute-text-${correctMinute}`);
            if (currentMinuteEl) {
                // ハイライト用の円を作成
                const highlightCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                highlightCircle.setAttribute('cx', currentMinuteEl.getAttribute('x'));
                highlightCircle.setAttribute('cy', currentMinuteEl.getAttribute('y'));
                highlightCircle.setAttribute('r', '8');
                highlightCircle.setAttribute('class', 'minute-highlight-circle');
                
                // テキストの前に円を挿入
                numbersContainer.insertBefore(highlightCircle, currentMinuteEl);
                
                // テキストを白抜き・太字にする
                currentMinuteEl.setAttribute('fill', 'white');
                currentMinuteEl.setAttribute('font-weight', 'bold');
                currentMinuteEl.textContent = correctMinute.toString().padStart(2, '0');

                // リセット用に要素を保存
                previouslyHighlightedMinuteEl = currentMinuteEl;
                previouslyHighlightedCircleEl = highlightCircle;
            }
            
            // 答えを隠す
            resultMessage.textContent = '↑ わかるかな？';
            resultMessage.className = 'h-10 text-xl font-semibold text-gray-700 flex items-center justify-center mb-4';
        }

        // 「こたえをみる」ボタンの処理
        showAnswerBtn.addEventListener('click', function() {
            const displayHour = correctHour === 0 ? 12 : correctHour;
            const displayMinute = correctMinute.toString().padStart(2, '0');
            resultMessage.textContent = `こたえ: ${displayHour}時 ${displayMinute}分`;
            resultMessage.className = 'h-10 text-xl font-semibold text-green-600 flex items-center justify-center mb-4';
        });
        
        // 「つぎのもんだい」ボタンの処理
        nextQuestionBtn.addEventListener('click', generateNewProblem);

        // 初期化
        createMarkers();
        generateNewProblem();

    </script>
</body>
</html>

